#-----------------------------------
#
#Github actions
#
#-----------------------------------
name: Deployment for Project X

on:
  push:
    branches: [main, master]

jobs:

 setup_env:
  runs-on: ubuntu-latest
  steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Setup Java 25
      uses: actions/setup-java@v5
      with:
        distribution: 'temurin'
        java-version: '25'

    - name: Setup Maven
      uses: actions/setup-java@v5
      with:
        distribution: 'temurin'
        java-version: '25'
        cache: 'maven'

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '20'

    - name: Verify environment
      run: |
        java -version
        mvn -version
        python --version
        node --version

 deploy_dev:
    runs-on: ubuntu-latest
    needs: setup_env
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Build and deploy to Dev
        run: |
          mvn clean install
          echo "Deploying to Dev environment..."
          # Add your Dev deployment commands here

 deploy_stage:
    runs-on: ubuntu-latest
    needs: deploy_dev
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Build and deploy to Stage
        run: |
          mvn clean install
          echo "Deploying to Stage environment..."
          # Add your Stage deployment commands here
        
      - name: Compile HelloWorldApp.java
        run: javac HelloWorldApp.java

      - name: Run HelloWorldApp
        run: java HelloWorldApp

    # Manual Production Deployment (workflow_dispatch)
 
 deploy_production:
    runs-on: ubuntu-latest
    if: github.event_name == 'workflow_dispatch'
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Build and deploy to Production
        run: |
          mvn clean install
          echo "Deploying to Production..."
          # Add Production deployment commands here